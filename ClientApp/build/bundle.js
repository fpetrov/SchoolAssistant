var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(n)}function s(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e,n,o){if(t){const r=l(t,e,n,o);return t[0](r)}}function l(t,n,o,r){return t[1]&&r?e(o.ctx.slice(),t[1](r(n))):o.ctx}function u(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}function a(t,e,n,o,r,s){if(r){const c=l(e,n,o,s);t.p(c,r)}}function f(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function d(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function p(t){return null==t?"":t}function h(t,e){t.appendChild(e)}function $(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function _(){return g(" ")}function b(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t,e){t.value=null==e?"":e}let w;function k(t){w=t}const C=[],E=[];let j=[];const T=[],A=Promise.resolve();let O=!1;function B(t){j.push(t)}function S(t){T.push(t)}const q=new Set;let N=0;function R(){if(0!==N)return;const t=w;do{try{for(;N<C.length;){const t=C[N];N++,k(t),L(t.$$)}}catch(t){throw C.length=0,N=0,t}for(k(null),C.length=0,N=0;E.length;)E.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];q.has(e)||(q.add(e),e())}j.length=0}while(C.length);for(;T.length;)T.pop()();O=!1,q.clear(),k(t)}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const M=new Set;let P;function D(){P={r:0,c:[],p:P}}function z(){P.r||r(P.c),P=P.p}function H(t,e){t&&t.i&&(M.delete(t),t.i(e))}function J(t,e,n,o){if(t&&t.o){if(M.has(t))return;M.add(t),P.c.push((()=>{M.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}const U="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function F(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function G(t){t&&t.c()}function I(t,e,o,c){const{fragment:i,after_update:l}=t.$$;i&&i.m(e,o),c||B((()=>{const e=t.$$.on_mount.map(n).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):r(e),t.$$.on_mount=[]})),l.forEach(B)}function W(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];j.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),j=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function K(t,e){-1===t.$$.dirty[0]&&(C.push(t),O||(O=!0,A.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(e,n,s,c,i,l,u,a=[-1]){const f=w;k(e);const d=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:i,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:a,skip_bound:!1,root:n.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=s?s(e,n.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),p&&K(e,t)),n})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!c&&c(d.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(y)}else d.fragment&&d.fragment.c();n.intro&&H(e.$$.fragment),I(e,n.target,n.anchor,n.customElement),R()}k(f)}class V{$destroy(){W(this,1),this.$destroy=t}$on(e,n){if(!s(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function X(t){let e,n;const o=t[3].default,r=i(o,t,t[2],null);return{c(){e=m("div"),r&&r.c(),v(e,"style",t[0]),v(e,"id",t[1]),v(e,"class","svelte-dj71z6")},m(t,o){$(t,e,o),r&&r.m(e,null),n=!0},p(t,[s]){r&&r.p&&(!n||4&s)&&a(r,o,t,t[2],n?u(o,t[2],s,null):f(t[2]),null),(!n||1&s)&&v(e,"style",t[0]),(!n||2&s)&&v(e,"id",t[1])},i(t){n||(H(r,t),n=!0)},o(t){J(r,t),n=!1},d(t){t&&y(e),r&&r.d(t)}}}function Y(t,e,n){let{$$slots:o={},$$scope:r}=e,{style:s=""}=e,{id:c=""}=e;return t.$$set=t=>{"style"in t&&n(0,s=t.style),"id"in t&&n(1,c=t.id),"$$scope"in t&&n(2,r=t.$$scope)},[s,c,r,o]}class Z extends V{constructor(t){super(),Q(this,t,Y,X,c,{style:0,id:1})}}function tt(t){let e,n,o,r,c;const l=t[4].default,d=i(l,t,t[3],null);return{c(){e=m("button"),d&&d.c(),v(e,"style",t[1]),v(e,"class",n=p(t[2].class)+" svelte-11363yy")},m(n,i){$(n,e,i),d&&d.m(e,null),o=!0,r||(c=b(e,"click",(function(){s(t[0])&&t[0].apply(this,arguments)})),r=!0)},p(r,[s]){t=r,d&&d.p&&(!o||8&s)&&a(d,l,t,t[3],o?u(l,t[3],s,null):f(t[3]),null),(!o||2&s)&&v(e,"style",t[1]),(!o||4&s&&n!==(n=p(t[2].class)+" svelte-11363yy"))&&v(e,"class",n)},i(t){o||(H(d,t),o=!0)},o(t){J(d,t),o=!1},d(t){t&&y(e),d&&d.d(t),r=!1,c()}}}function et(t,n,o){let{$$slots:r={},$$scope:s}=n,{onClick:c}=n,{style:i}=n;return t.$$set=t=>{o(2,n=e(e({},n),d(t))),"onClick"in t&&o(0,c=t.onClick),"style"in t&&o(1,i=t.style),"$$scope"in t&&o(3,s=t.$$scope)},n=d(n),[c,i,n,s,r]}class nt extends V{constructor(t){super(),Q(this,t,et,tt,c,{onClick:0,style:1})}}function ot(t){let e;return{c(){e=g("Отправить")},m(t,n){$(t,e,n)},d(t){t&&y(e)}}}function rt(t){let e,n,o,r,s,c,i,l,u;return c=new nt({props:{onClick:t[3],class:"text-lg send-button",$$slots:{default:[ot]},$$scope:{ctx:t}}}),{c(){e=m("div"),n=m("input"),s=_(),G(c.$$.fragment),n.autofocus=!0,v(n,"class","text-u-sm svelte-rob3vu"),v(n,"type","text"),v(n,"placeholder",t[2]),v(n,"name",o=t[4].name),v(n,"id",r=t[4].name),n.required=!0,v(e,"class","svelte-rob3vu")},m(o,r){$(o,e,r),h(e,n),t[5](n),x(n,t[0]),h(e,s),I(c,e,null),i=!0,n.focus(),l||(u=b(n,"input",t[6]),l=!0)},p(t,[e]){(!i||4&e)&&v(n,"placeholder",t[2]),(!i||16&e&&o!==(o=t[4].name))&&v(n,"name",o),(!i||16&e&&r!==(r=t[4].name))&&v(n,"id",r),1&e&&n.value!==t[0]&&x(n,t[0]);const s={};8&e&&(s.onClick=t[3]),128&e&&(s.$$scope={dirty:e,ctx:t}),c.$set(s)},i(t){i||(H(c.$$.fragment,t),i=!0)},o(t){J(c.$$.fragment,t),i=!1},d(n){n&&y(e),t[5](null),W(c),l=!1,u()}}}function st(t,n,o){let{placeholder:r}=n,{value:s=""}=n,{input:c}=n,{onButtonClick:i=""}=n;return t.$$set=t=>{o(4,n=e(e({},n),d(t))),"placeholder"in t&&o(2,r=t.placeholder),"value"in t&&o(0,s=t.value),"input"in t&&o(1,c=t.input),"onButtonClick"in t&&o(3,i=t.onButtonClick)},n=d(n),[s,c,r,i,n,function(t){E[t?"unshift":"push"]((()=>{c=t,o(1,c)}))},function(){s=this.value,o(0,s)}]}class ct extends V{constructor(t){super(),Q(this,t,st,rt,c,{placeholder:2,value:0,input:1,onButtonClick:3})}}function it(t){let e,n,o,r,s;const c=t[2].default,l=i(c,t,t[1],null);return{c(){e=m("div"),n=m("span"),n.textContent="Помощник:",o=_(),r=m("div"),l&&l.c(),v(n,"class","text-sm"),v(r,"class","text-sm"),v(e,"class","message bot svelte-1xppub1")},m(t,c){$(t,e,c),h(e,n),h(e,o),h(e,r),l&&l.m(r,null),s=!0},p(t,e){l&&l.p&&(!s||2&e)&&a(l,c,t,t[1],s?u(c,t[1],e,null):f(t[1]),null)},i(t){s||(H(l,t),s=!0)},o(t){J(l,t),s=!1},d(t){t&&y(e),l&&l.d(t)}}}function lt(t){let e,n,o,r,s;const c=t[2].default,l=i(c,t,t[1],null);return{c(){e=m("div"),n=m("span"),n.textContent="Вы:",o=_(),r=m("p"),l&&l.c(),v(n,"class","text-sm"),v(r,"class","text-sm"),v(e,"class","message svelte-1xppub1")},m(t,c){$(t,e,c),h(e,n),h(e,o),h(e,r),l&&l.m(r,null),s=!0},p(t,e){l&&l.p&&(!s||2&e)&&a(l,c,t,t[1],s?u(c,t[1],e,null):f(t[1]),null)},i(t){s||(H(l,t),s=!0)},o(t){J(l,t),s=!1},d(t){t&&y(e),l&&l.d(t)}}}function ut(t){let e,n,o,r;const s=[lt,it],c=[];function i(t,e){return"user"==t[0]?0:1}return e=i(t),n=c[e]=s[e](t),{c(){n.c(),o=g("")},m(t,n){c[e].m(t,n),$(t,o,n),r=!0},p(t,[r]){let l=e;e=i(t),e===l?c[e].p(t,r):(D(),J(c[l],1,1,(()=>{c[l]=null})),z(),n=c[e],n?n.p(t,r):(n=c[e]=s[e](t),n.c()),H(n,1),n.m(o.parentNode,o))},i(t){r||(H(n),r=!0)},o(t){J(n),r=!1},d(t){c[e].d(t),t&&y(o)}}}function at(t,e,n){let{$$slots:o={},$$scope:r}=e,{type:s=0}=e;return t.$$set=t=>{"type"in t&&n(0,s=t.type),"$$scope"in t&&n(1,r=t.$$scope)},[s,r,o]}class ft extends V{constructor(t){super(),Q(this,t,at,ut,c,{type:0})}}const dt="Content-Type",pt=Symbol();function ht(t={}){var e;return null===(e=Object.entries(t).find((([t])=>t.toLowerCase()===dt.toLowerCase())))||void 0===e?void 0:e[1]}function $t(t){return/^application\/.*json.*/.test(t)}const yt=function(t,e,n=!1){return Object.entries(e).reduce(((e,[o,r])=>{const s=t[o];return Array.isArray(s)&&Array.isArray(r)?e[o]=n?[...s,...r]:r:e[o]="object"==typeof s&&"object"==typeof r?yt(s,r,n):r,e}),{...t})},mt={options:{},errorType:"text",polyfills:{},polyfill(t,e=!0,n=!1,...o){const r=this.polyfills[t]||("undefined"!=typeof self?self[t]:null)||("undefined"!=typeof global?global[t]:null);if(e&&!r)throw new Error(t+" is not defined");return n&&r?new r(...o):r}};class gt extends Error{}const _t=t=>{const e=Object.create(null);t=t._addons.reduce(((n,o)=>o.beforeRequest&&o.beforeRequest(n,t._options,e)||n),t);const{_url:n,_options:o,_config:r,_catchers:s,_resolvers:c,_middlewares:i,_addons:l}=t,u=new Map(s),a=yt(r.options,o);let f=n;const d=(t=>e=>t.reduceRight(((t,e)=>e(t)),e)||e)(i)(((t,e)=>(f=t,r.polyfill("fetch")(t,e))))(n,a),p=new Error,h=d.catch((t=>{throw{__wrap:t}})).then((t=>{if(!t.ok){const e=new gt;if(e.cause=p,e.stack=e.stack+"\nCAUSE: "+p.stack,e.response=t,e.url=f,"opaque"===t.type)throw e;return t.text().then((n=>{var o;if(e.message=n,"json"===r.errorType||"application/json"===(null===(o=t.headers.get("Content-Type"))||void 0===o?void 0:o.split(";")[0]))try{e.json=JSON.parse(n)}catch(t){}throw e.text=n,e.status=t.status,e}))}return t})),$=e=>e.catch((e=>{const n=e.__wrap||e,o=n.status&&u.get(n.status)||u.get(n.name)||e.__wrap&&u.has(pt)&&u.get(pt);if(o)return o(n,t);throw n})),y=t=>e=>$(t?h.then((e=>e&&e[t]())).then((t=>e?e(t):t)):h.then((t=>e?e(t):t))),m={_wretchReq:t,_fetchReq:d,_sharedState:e,res:y(null),json:y("json"),blob:y("blob"),formData:y("formData"),arrayBuffer:y("arrayBuffer"),text:y("text"),error(t,e){return u.set(t,e),this},badRequest(t){return this.error(400,t)},unauthorized(t){return this.error(401,t)},forbidden(t){return this.error(403,t)},notFound(t){return this.error(404,t)},timeout(t){return this.error(408,t)},internalError(t){return this.error(500,t)},fetchError(t){return this.error(pt,t)}},g=l.reduce(((t,e)=>({...t,...e.resolver})),m);return c.reduce(((e,n)=>n(e,t)),g)},bt={_url:"",_options:{},_config:mt,_catchers:new Map,_resolvers:[],_deferred:[],_middlewares:[],_addons:[],addon(t){return{...this,_addons:[...this._addons,t],...t.wretch}},errorType(t){return{...this,_config:{...this._config,errorType:t}}},polyfills(t,e=!1){return{...this,_config:{...this._config,polyfills:e?t:yt(this._config.polyfills,t)}}},url(t,e=!1){if(e)return{...this,_url:t};const n=this._url.split("?");return{...this,_url:n.length>1?n[0]+t+"?"+n[1]:this._url+t}},options(t,e=!1){return{...this,_options:e?t:yt(this._options,t)}},headers(t){return{...this,_options:yt(this._options,{headers:t||{}})}},accept(t){return this.headers({Accept:t})},content(t){return this.headers({[dt]:t})},auth(t){return this.headers({Authorization:t})},catcher(t,e){const n=new Map(this._catchers);return n.set(t,e),{...this,_catchers:n}},resolve(t,e=!1){return{...this,_resolvers:e?[t]:[...this._resolvers,t]}},defer(t,e=!1){return{...this,_deferred:e?[t]:[...this._deferred,t]}},middlewares(t,e=!1){return{...this,_middlewares:e?t:[...this._middlewares,...t]}},fetch(t=this._options.method,e="",n=null){let o=this.url(e).options({method:t});const r=ht(o._options.headers),s="object"==typeof n&&(!o._options.headers||!r||$t(r));return o=n?s?o.json(n,r):o.body(n):o,_t(o._deferred.reduce(((t,e)=>e(t,t._url,t._options)),o))},get(t=""){return this.fetch("GET",t)},delete(t=""){return this.fetch("DELETE",t)},put(t,e=""){return this.fetch("PUT",e,t)},post(t,e=""){return this.fetch("POST",e,t)},patch(t,e=""){return this.fetch("PATCH",e,t)},head(t=""){return this.fetch("HEAD",t)},opts(t=""){return this.fetch("OPTIONS",t)},body(t){return{...this,_options:{...this._options,body:t}}},json(t,e){const n=ht(this._options.headers);return this.content(e||$t(n)&&n||"application/json").body(JSON.stringify(t))}};function vt(t="",e={}){return{...bt,_url:t,_options:e}}vt.default=vt,vt.options=function(t,e=!1){mt.options=e?t:yt(mt.options,t)},vt.errorType=function(t){mt.errorType=t},vt.polyfills=function(t,e=!1){mt.polyfills=e?t:yt(mt.polyfills,t)},vt.WretchError=gt;const{window:xt}=U;function wt(t,e,n){const o=t.slice();return o[10]=e[n],o}function kt(t){let e,n=t[10].content+"";return{c(){e=g(n)},m(t,n){$(t,e,n)},p(t,o){4&o&&n!==(n=t[10].content+"")&&function(t,e){e=""+e,t.data!==e&&(t.data=e)}(e,n)},d(t){t&&y(e)}}}function Ct(t){let e,n;return e=new ft({props:{type:t[10].role,$$slots:{default:[kt]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment)},m(t,o){I(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.type=t[10].role),8196&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){W(e,t)}}}function Et(t){let e,n,o,r,s=t[2].slice(1),c=[];for(let e=0;e<s.length;e+=1)c[e]=Ct(wt(t,s,e));const i=t=>J(c[t],1,1,(()=>{c[t]=null}));return{c(){e=m("h1"),e.textContent="Школьный помощник",n=_(),o=m("div");for(let t=0;t<c.length;t+=1)c[t].c();v(e,"class","text-lg gradient-purple"),v(o,"class","messages svelte-4v3fx3")},m(t,s){$(t,e,s),$(t,n,s),$(t,o,s);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(o,null);r=!0},p(t,e){if(4&e){let n;for(s=t[2].slice(1),n=0;n<s.length;n+=1){const r=wt(t,s,n);c[n]?(c[n].p(r,e),H(c[n],1)):(c[n]=Ct(r),c[n].c(),H(c[n],1),c[n].m(o,null))}for(D(),n=s.length;n<c.length;n+=1)i(n);z()}},i(t){if(!r){for(let t=0;t<s.length;t+=1)H(c[t]);r=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)J(c[t]);r=!1},d(t){t&&y(e),t&&y(n),t&&y(o),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(c,t)}}}function jt(t){let e,n,o,r,s,c,i,l;function u(e){t[7](e)}function a(e){t[8](e)}let f={name:"message",placeholder:"Ваш вопрос",onButtonClick:t[6]};return void 0!==t[1]&&(f.input=t[1]),void 0!==t[0]&&(f.value=t[0]),e=new ct({props:f}),E.push((()=>F(e,"input",u))),E.push((()=>F(e,"value",a))),s=new Z({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),{c(){G(e.$$.fragment),r=_(),G(s.$$.fragment)},m(n,o){I(e,n,o),$(n,r,o),I(s,n,o),c=!0,i||(l=b(xt,"keydown",t[5]),i=!0)},p(t,[r]){const c={};1&r&&(c.onButtonClick=t[6]),!n&&2&r&&(n=!0,c.input=t[1],S((()=>n=!1))),!o&&1&r&&(o=!0,c.value=t[0],S((()=>o=!1))),e.$set(c);const i={};8196&r&&(i.$$scope={dirty:r,ctx:t}),s.$set(i)},i(t){c||(H(e.$$.fragment,t),H(s.$$.fragment,t),c=!0)},o(t){J(e.$$.fragment,t),J(s.$$.fragment,t),c=!1},d(t){W(e,t),t&&y(r),W(s,t),i=!1,l()}}}function Tt(t,e,n){let o;function r(t){s(t),vt().url("/ask").post({messages_history:o}).json((t=>{s(function(t){return t.replace(/(https?:\/\/[^\s]+)/g,(function(t){return'<a href="'+t+'">'+t+"</a>"}))}(t.content),"assistant")})).catch((t=>{console.log(t)}))}function s(t,e="user"){0!=t.length&&(o.push({role:e,content:t}),n(2,o),window.scroll({top:document.body.scrollHeight,behavior:"smooth"}),n(0,l=""),i.focus())}function c(t){13==t.keyCode&&r(l)}let i,l="";return n(2,o=[{role:"system",content:"Представь, что ты школьный учитель. Тебе нужно отвечать на вопросы учеников. В твоих ответах ты должен быть приветлив и максимально четко объяснить школьную тему, которую у тебя спросили."}]),[l,i,o,r,c,t=>c(t),()=>r(l),function(t){i=t,n(1,i)},function(t){l=t,n(0,l)}]}return new class extends V{constructor(t){super(),Q(this,t,Tt,jt,c,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
