var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function s(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e,n,r){if(t){const o=l(t,e,n,r);return t[0](o)}}function l(t,n,r,o){return t[1]&&o?e(r.ctx.slice(),t[1](o(n))):r.ctx}function u(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function a(t,e,n,r,o,s){if(o){const c=l(e,n,r,s);t.p(c,o)}}function f(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function d(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function p(t){return null==t?"":t}function h(t,e){t.appendChild(e)}function $(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode&&t.parentNode.removeChild(t)}function y(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function _(){return g(" ")}function v(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){t.value=null==e?"":e}let w;function k(t){w=t}const C=[],E=[];let j=[];const T=[],A=Promise.resolve();let O=!1;function B(t){j.push(t)}function S(t){T.push(t)}const q=new Set;let N=0;function R(){if(0!==N)return;const t=w;do{try{for(;N<C.length;){const t=C[N];N++,k(t),L(t.$$)}}catch(t){throw C.length=0,N=0,t}for(k(null),C.length=0,N=0;E.length;)E.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];q.has(e)||(q.add(e),e())}j.length=0}while(C.length);for(;T.length;)T.pop()();O=!1,q.clear(),k(t)}function L(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const M=new Set;let P;function D(){P={r:0,c:[],p:P}}function z(){P.r||o(P.c),P=P.p}function H(t,e){t&&t.i&&(M.delete(t),t.i(e))}function J(t,e,n,r){if(t&&t.o){if(M.has(t))return;M.add(t),P.c.push((()=>{M.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}function U(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function F(t){t&&t.c()}function G(t,e,r,c){const{fragment:i,after_update:l}=t.$$;i&&i.m(e,r),c||B((()=>{const e=t.$$.on_mount.map(n).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[]})),l.forEach(B)}function I(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];j.forEach((r=>-1===t.indexOf(r)?e.push(r):n.push(r))),n.forEach((t=>t())),j=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(C.push(t),O||(O=!0,A.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,n,s,c,i,l,u,a=[-1]){const f=w;k(e);const d=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:i,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:r(),dirty:a,skip_bound:!1,root:n.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=s?s(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),p&&W(e,t)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!c&&c(d.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(m)}else d.fragment&&d.fragment.c();n.intro&&H(e.$$.fragment),G(e,n.target,n.anchor,n.customElement),R()}k(f)}class Q{$destroy(){I(this,1),this.$destroy=t}$on(e,n){if(!s(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function V(t){let e,n;const r=t[3].default,o=i(r,t,t[2],null);return{c(){e=y("div"),o&&o.c(),x(e,"style",t[0]),x(e,"id",t[1]),x(e,"class","svelte-dj71z6")},m(t,r){$(t,e,r),o&&o.m(e,null),n=!0},p(t,[s]){o&&o.p&&(!n||4&s)&&a(o,r,t,t[2],n?u(r,t[2],s,null):f(t[2]),null),(!n||1&s)&&x(e,"style",t[0]),(!n||2&s)&&x(e,"id",t[1])},i(t){n||(H(o,t),n=!0)},o(t){J(o,t),n=!1},d(t){t&&m(e),o&&o.d(t)}}}function X(t,e,n){let{$$slots:r={},$$scope:o}=e,{style:s=""}=e,{id:c=""}=e;return t.$$set=t=>{"style"in t&&n(0,s=t.style),"id"in t&&n(1,c=t.id),"$$scope"in t&&n(2,o=t.$$scope)},[s,c,o,r]}class Y extends Q{constructor(t){super(),K(this,t,X,V,c,{style:0,id:1})}}function Z(t){let e,n,r,o,c;const l=t[4].default,d=i(l,t,t[3],null);return{c(){e=y("button"),d&&d.c(),x(e,"style",t[1]),x(e,"class",n=p(t[2].class)+" svelte-11363yy")},m(n,i){$(n,e,i),d&&d.m(e,null),r=!0,o||(c=v(e,"click",(function(){s(t[0])&&t[0].apply(this,arguments)})),o=!0)},p(o,[s]){t=o,d&&d.p&&(!r||8&s)&&a(d,l,t,t[3],r?u(l,t[3],s,null):f(t[3]),null),(!r||2&s)&&x(e,"style",t[1]),(!r||4&s&&n!==(n=p(t[2].class)+" svelte-11363yy"))&&x(e,"class",n)},i(t){r||(H(d,t),r=!0)},o(t){J(d,t),r=!1},d(t){t&&m(e),d&&d.d(t),o=!1,c()}}}function tt(t,n,r){let{$$slots:o={},$$scope:s}=n,{onClick:c}=n,{style:i}=n;return t.$$set=t=>{r(2,n=e(e({},n),d(t))),"onClick"in t&&r(0,c=t.onClick),"style"in t&&r(1,i=t.style),"$$scope"in t&&r(3,s=t.$$scope)},n=d(n),[c,i,n,s,o]}class et extends Q{constructor(t){super(),K(this,t,tt,Z,c,{onClick:0,style:1})}}function nt(t){let e;return{c(){e=g("Отправить")},m(t,n){$(t,e,n)},d(t){t&&m(e)}}}function rt(t){let e,n,r,o,s,c,i,l,u;return c=new et({props:{onClick:t[3],class:"text-lg send-button",$$slots:{default:[nt]},$$scope:{ctx:t}}}),{c(){e=y("div"),n=y("input"),s=_(),F(c.$$.fragment),n.autofocus=!0,x(n,"class","text-u-sm svelte-rob3vu"),x(n,"type","text"),x(n,"placeholder",t[2]),x(n,"name",r=t[4].name),x(n,"id",o=t[4].name),n.required=!0,x(e,"class","svelte-rob3vu")},m(r,o){$(r,e,o),h(e,n),t[5](n),b(n,t[0]),h(e,s),G(c,e,null),i=!0,n.focus(),l||(u=v(n,"input",t[6]),l=!0)},p(t,[e]){(!i||4&e)&&x(n,"placeholder",t[2]),(!i||16&e&&r!==(r=t[4].name))&&x(n,"name",r),(!i||16&e&&o!==(o=t[4].name))&&x(n,"id",o),1&e&&n.value!==t[0]&&b(n,t[0]);const s={};8&e&&(s.onClick=t[3]),128&e&&(s.$$scope={dirty:e,ctx:t}),c.$set(s)},i(t){i||(H(c.$$.fragment,t),i=!0)},o(t){J(c.$$.fragment,t),i=!1},d(n){n&&m(e),t[5](null),I(c),l=!1,u()}}}function ot(t,n,r){let{placeholder:o}=n,{value:s=""}=n,{input:c}=n,{onButtonClick:i=""}=n;return t.$$set=t=>{r(4,n=e(e({},n),d(t))),"placeholder"in t&&r(2,o=t.placeholder),"value"in t&&r(0,s=t.value),"input"in t&&r(1,c=t.input),"onButtonClick"in t&&r(3,i=t.onButtonClick)},n=d(n),[s,c,o,i,n,function(t){E[t?"unshift":"push"]((()=>{c=t,r(1,c)}))},function(){s=this.value,r(0,s)}]}class st extends Q{constructor(t){super(),K(this,t,ot,rt,c,{placeholder:2,value:0,input:1,onButtonClick:3})}}function ct(t){let e,n,r,o,s;const c=t[2].default,l=i(c,t,t[1],null);return{c(){e=y("div"),n=y("span"),n.textContent="Помощник:",r=_(),o=y("div"),l&&l.c(),x(n,"class","text-sm"),x(o,"class","text-sm"),x(e,"class","message bot svelte-1aw7wct")},m(t,c){$(t,e,c),h(e,n),h(e,r),h(e,o),l&&l.m(o,null),s=!0},p(t,e){l&&l.p&&(!s||2&e)&&a(l,c,t,t[1],s?u(c,t[1],e,null):f(t[1]),null)},i(t){s||(H(l,t),s=!0)},o(t){J(l,t),s=!1},d(t){t&&m(e),l&&l.d(t)}}}function it(t){let e,n,r,o,s;const c=t[2].default,l=i(c,t,t[1],null);return{c(){e=y("div"),n=y("span"),n.textContent="Вы:",r=_(),o=y("p"),l&&l.c(),x(n,"class","text-sm"),x(o,"class","text-sm"),x(e,"class","message svelte-1aw7wct")},m(t,c){$(t,e,c),h(e,n),h(e,r),h(e,o),l&&l.m(o,null),s=!0},p(t,e){l&&l.p&&(!s||2&e)&&a(l,c,t,t[1],s?u(c,t[1],e,null):f(t[1]),null)},i(t){s||(H(l,t),s=!0)},o(t){J(l,t),s=!1},d(t){t&&m(e),l&&l.d(t)}}}function lt(t){let e,n,r,o;const s=[it,ct],c=[];function i(t,e){return 0==t[0]?0:1}return e=i(t),n=c[e]=s[e](t),{c(){n.c(),r=g("")},m(t,n){c[e].m(t,n),$(t,r,n),o=!0},p(t,[o]){let l=e;e=i(t),e===l?c[e].p(t,o):(D(),J(c[l],1,1,(()=>{c[l]=null})),z(),n=c[e],n?n.p(t,o):(n=c[e]=s[e](t),n.c()),H(n,1),n.m(r.parentNode,r))},i(t){o||(H(n),o=!0)},o(t){J(n),o=!1},d(t){c[e].d(t),t&&m(r)}}}function ut(t,e,n){let{$$slots:r={},$$scope:o}=e,{type:s=0}=e;return t.$$set=t=>{"type"in t&&n(0,s=t.type),"$$scope"in t&&n(1,o=t.$$scope)},[s,o,r]}class at extends Q{constructor(t){super(),K(this,t,ut,lt,c,{type:0})}}const ft="Content-Type",dt=Symbol();function pt(t={}){var e;return null===(e=Object.entries(t).find((([t])=>t.toLowerCase()===ft.toLowerCase())))||void 0===e?void 0:e[1]}function ht(t){return/^application\/.*json.*/.test(t)}const $t=function(t,e,n=!1){return Object.entries(e).reduce(((e,[r,o])=>{const s=t[r];return Array.isArray(s)&&Array.isArray(o)?e[r]=n?[...s,...o]:o:e[r]="object"==typeof s&&"object"==typeof o?$t(s,o,n):o,e}),{...t})},mt={options:{},errorType:"text",polyfills:{},polyfill(t,e=!0,n=!1,...r){const o=this.polyfills[t]||("undefined"!=typeof self?self[t]:null)||("undefined"!=typeof global?global[t]:null);if(e&&!o)throw new Error(t+" is not defined");return n&&o?new o(...r):o}};class yt extends Error{}const gt=t=>{const e=Object.create(null);t=t._addons.reduce(((n,r)=>r.beforeRequest&&r.beforeRequest(n,t._options,e)||n),t);const{_url:n,_options:r,_config:o,_catchers:s,_resolvers:c,_middlewares:i,_addons:l}=t,u=new Map(s),a=$t(o.options,r);let f=n;const d=(t=>e=>t.reduceRight(((t,e)=>e(t)),e)||e)(i)(((t,e)=>(f=t,o.polyfill("fetch")(t,e))))(n,a),p=new Error,h=d.catch((t=>{throw{__wrap:t}})).then((t=>{if(!t.ok){const e=new yt;if(e.cause=p,e.stack=e.stack+"\nCAUSE: "+p.stack,e.response=t,e.url=f,"opaque"===t.type)throw e;return t.text().then((n=>{var r;if(e.message=n,"json"===o.errorType||"application/json"===(null===(r=t.headers.get("Content-Type"))||void 0===r?void 0:r.split(";")[0]))try{e.json=JSON.parse(n)}catch(t){}throw e.text=n,e.status=t.status,e}))}return t})),$=e=>e.catch((e=>{const n=e.__wrap||e,r=n.status&&u.get(n.status)||u.get(n.name)||e.__wrap&&u.has(dt)&&u.get(dt);if(r)return r(n,t);throw n})),m=t=>e=>$(t?h.then((e=>e&&e[t]())).then((t=>e?e(t):t)):h.then((t=>e?e(t):t))),y={_wretchReq:t,_fetchReq:d,_sharedState:e,res:m(null),json:m("json"),blob:m("blob"),formData:m("formData"),arrayBuffer:m("arrayBuffer"),text:m("text"),error(t,e){return u.set(t,e),this},badRequest(t){return this.error(400,t)},unauthorized(t){return this.error(401,t)},forbidden(t){return this.error(403,t)},notFound(t){return this.error(404,t)},timeout(t){return this.error(408,t)},internalError(t){return this.error(500,t)},fetchError(t){return this.error(dt,t)}},g=l.reduce(((t,e)=>({...t,...e.resolver})),y);return c.reduce(((e,n)=>n(e,t)),g)},_t={_url:"",_options:{},_config:mt,_catchers:new Map,_resolvers:[],_deferred:[],_middlewares:[],_addons:[],addon(t){return{...this,_addons:[...this._addons,t],...t.wretch}},errorType(t){return{...this,_config:{...this._config,errorType:t}}},polyfills(t,e=!1){return{...this,_config:{...this._config,polyfills:e?t:$t(this._config.polyfills,t)}}},url(t,e=!1){if(e)return{...this,_url:t};const n=this._url.split("?");return{...this,_url:n.length>1?n[0]+t+"?"+n[1]:this._url+t}},options(t,e=!1){return{...this,_options:e?t:$t(this._options,t)}},headers(t){return{...this,_options:$t(this._options,{headers:t||{}})}},accept(t){return this.headers({Accept:t})},content(t){return this.headers({[ft]:t})},auth(t){return this.headers({Authorization:t})},catcher(t,e){const n=new Map(this._catchers);return n.set(t,e),{...this,_catchers:n}},resolve(t,e=!1){return{...this,_resolvers:e?[t]:[...this._resolvers,t]}},defer(t,e=!1){return{...this,_deferred:e?[t]:[...this._deferred,t]}},middlewares(t,e=!1){return{...this,_middlewares:e?t:[...this._middlewares,...t]}},fetch(t=this._options.method,e="",n=null){let r=this.url(e).options({method:t});const o=pt(r._options.headers),s="object"==typeof n&&(!r._options.headers||!o||ht(o));return r=n?s?r.json(n,o):r.body(n):r,gt(r._deferred.reduce(((t,e)=>e(t,t._url,t._options)),r))},get(t=""){return this.fetch("GET",t)},delete(t=""){return this.fetch("DELETE",t)},put(t,e=""){return this.fetch("PUT",e,t)},post(t,e=""){return this.fetch("POST",e,t)},patch(t,e=""){return this.fetch("PATCH",e,t)},head(t=""){return this.fetch("HEAD",t)},opts(t=""){return this.fetch("OPTIONS",t)},body(t){return{...this,_options:{...this._options,body:t}}},json(t,e){const n=pt(this._options.headers);return this.content(e||ht(n)&&n||"application/json").body(JSON.stringify(t))}};function vt(t="",e={}){return{..._t,_url:t,_options:e}}function xt(t,e,n){const r=t.slice();return r[10]=e[n],r}function bt(t){let e,n=t[10].content+"";return{c(){e=g(n)},m(t,n){$(t,e,n)},p(t,r){4&r&&n!==(n=t[10].content+"")&&function(t,e){e=""+e,t.data!==e&&(t.data=e)}(e,n)},d(t){t&&m(e)}}}function wt(t){let e,n;return e=new at({props:{type:"0",$$slots:{default:[bt]},$$scope:{ctx:t}}}),{c(){F(e.$$.fragment)},m(t,r){G(e,t,r),n=!0},p(t,n){const r={};8196&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function kt(t){let e,n,r,o,s=t[2].slice(1),c=[];for(let e=0;e<s.length;e+=1)c[e]=wt(xt(t,s,e));const i=t=>J(c[t],1,1,(()=>{c[t]=null}));return{c(){e=y("h1"),e.textContent="Школьный помощник",n=_(),r=y("div");for(let t=0;t<c.length;t+=1)c[t].c();x(e,"class","text-lg gradient-purple"),x(r,"class","messages svelte-4v3fx3")},m(t,s){$(t,e,s),$(t,n,s),$(t,r,s);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(r,null);o=!0},p(t,e){if(4&e){let n;for(s=t[2].slice(1),n=0;n<s.length;n+=1){const o=xt(t,s,n);c[n]?(c[n].p(o,e),H(c[n],1)):(c[n]=wt(o),c[n].c(),H(c[n],1),c[n].m(r,null))}for(D(),n=s.length;n<c.length;n+=1)i(n);z()}},i(t){if(!o){for(let t=0;t<s.length;t+=1)H(c[t]);o=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)J(c[t]);o=!1},d(t){t&&m(e),t&&m(n),t&&m(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(c,t)}}}function Ct(t){let e,n,r,o,s,c,i,l;function u(e){t[7](e)}function a(e){t[8](e)}let f={name:"message",placeholder:"Ваш вопрос",onButtonClick:t[6]};return void 0!==t[1]&&(f.input=t[1]),void 0!==t[0]&&(f.value=t[0]),e=new st({props:f}),E.push((()=>U(e,"input",u))),E.push((()=>U(e,"value",a))),s=new Y({props:{$$slots:{default:[kt]},$$scope:{ctx:t}}}),{c(){F(e.$$.fragment),o=_(),F(s.$$.fragment)},m(n,r){G(e,n,r),$(n,o,r),G(s,n,r),c=!0,i||(l=v(window,"keydown",t[5]),i=!0)},p(t,[o]){const c={};1&o&&(c.onButtonClick=t[6]),!n&&2&o&&(n=!0,c.input=t[1],S((()=>n=!1))),!r&&1&o&&(r=!0,c.value=t[0],S((()=>r=!1))),e.$set(c);const i={};8196&o&&(i.$$scope={dirty:o,ctx:t}),s.$set(i)},i(t){c||(H(e.$$.fragment,t),H(s.$$.fragment,t),c=!0)},o(t){J(e.$$.fragment,t),J(s.$$.fragment,t),c=!1},d(t){I(e,t),t&&m(o),I(s,t),i=!1,l()}}}function Et(t,e,n){let r;function o(t){s(t),vt().url("/ask").post({messages_history:r}).json((t=>{s(t.content,1)})).catch((t=>{console.log(t)}))}function s(t,e=0){if(0==t.length)return;let o="user";1==e&&(o="assistant"),r.push({role:o,content:t}),n(2,r),n(0,l=""),i.focus()}function c(t){13==t.keyCode&&o(l)}let i,l="";return n(2,r=[{role:"system",content:"Представь, что ты школьный учитель. Тебе нужно отвечать на вопросы учеников. В твоих ответах ты должен быть приветлив и максимально четко объяснить школьную тему, которую у тебя спросили."}]),[l,i,r,o,c,t=>c(t),()=>o(l),function(t){i=t,n(1,i)},function(t){l=t,n(0,l)}]}vt.default=vt,vt.options=function(t,e=!1){mt.options=e?t:$t(mt.options,t)},vt.errorType=function(t){mt.errorType=t},vt.polyfills=function(t,e=!1){mt.polyfills=e?t:$t(mt.polyfills,t)},vt.WretchError=yt;return new class extends Q{constructor(t){super(),K(this,t,Et,Ct,c,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
